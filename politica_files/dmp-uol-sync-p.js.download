!function(e){var t={};function a(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(s,r,function(t){return e[t]}.bind(null,r));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function s(e,t,a,s,r,o,i){try{var n=e[o](i),c=n.value}catch(e){return void a(e)}n.done?t(c):Promise.resolve(c).then(s,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,o){var i=e.apply(t,a);function n(e){s(i,r,o,n,c,"next",e)}function c(e){s(i,r,o,n,c,"throw",e)}n(void 0)}))}}function o(e){return i.apply(this,arguments)}function i(){return(i=r((function*(e){var t=new TextEncoder("utf-8").encode(e),a=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map((function(e){return("00"+e.toString(16)).slice(-2)})).join("")}))).apply(this,arguments)}function n(e,t,a,s,r,o,i){try{var n=e[o](i),c=n.value}catch(e){return void a(e)}n.done?t(c):Promise.resolve(c).then(s,r)}function c(e){return function(){var t=this,a=arguments;return new Promise((function(s,r){var o=e.apply(t,a);function i(e){n(o,s,r,i,c,"next",e)}function c(e){n(o,s,r,i,c,"throw",e)}i(void 0)}))}}a.r(t);var u="https://udr.uol.com.br",l={},p={sync:()=>c((function*(){yield p.syncUOLID(),yield p.loadUDRData(),yield Promise.all([p.syncTailTarget(),p.sendUOLIDToTailTarget(),p.syncXandrDMP(),p.syncPiano(),p.setCustomAudiencesInWindowsDataLayer()])}))(),get:e=>c((function*(){return yield fetch(e,{credentials:"include"})}))(),hasTM(){try{return!!window.UOLPD.TagManager}catch(e){return!1}},hasCX(){try{return!!window.cX}catch(e){return!1}},syncUOLID(){var e=this;return c((function*(){var t=(yield e.getLocalData())||{};e.persist(t),e.refreshSyncData(t)}))()},refreshSyncData(e){var t=this;return c((function*(){var a=t.isFolhaEnvironment()?"?xsrc=folha":"",s=yield t.get("".concat(u+a)),r=yield s.json();Object.assign(e,r),t.persist(e)}))()},isFolhaEnvironment:()=>/folha(\.uol)?\.com\.br/.test(location.origin),getUDRData:()=>l,loadUDRData(){var e=this;return c((function*(){var t=yield e.get("".concat(u,"/?scopes=base-assinantes,user-preferences,corporate,inscriptions,base-assinantes-pd-host-bol-user,clusters-conteudo,origem-sessoes,tabela-dinamica-clusters-conteudo,ca-apostas-2024,ca-apostas-v2-2024,teste-evino,ca-tim-usuarios-sete-acessos,ca-look-alike-v1")),a=yield t.json();l=a}))()},refreshClusterLocalStorage(e){var t=this;return c((function*(){var{data:a}=e,s=a["clusters-conteudo"]&&a["clusters-conteudo"].cluster||"-1",r=JSON.parse(localStorage.getItem("UDR.DATA"))||{data:{}};r.data["clusters-conteudo"]?r.data["clusters-conteudo"].cluster=s:Object.assign(r.data,{"clusters-conteudo":{cluster:s}}),t.persistLocal(JSON.stringify(r))}))()},syncPiano(){var e=this;return c((function*(){if(yield new Promise(e=>setTimeout(e,3e3)),e.hasCX()){var t=e.getUDRData();e.refreshClusterLocalStorage(t);var a=e.formatPianoProfile(t);if(a.length){console.log("piano profile",a);var s="https://api.cxense.com/profile/user/external/update?callback={{callback}}&persisted="+encodeURIComponent("d221a64af0b728fa6a6c3d8a81c50c89340769c7")+"&json="+encodeURIComponent(JSON.stringify({id:t.uolid,type:"tfh",profile:a}));cX.getCookie("T_PIANO")||(cX.jsonpRequest(s,(function(e){e.hasOwnProperty("httpStatus")&&200==e.httpStatus?(console.log("piano result: "),console.log(e)):console.log("No or bad http status")})),cX.setCookie("T_PIANO","t",30/1440))}}}))()},formatPianoProfile(e){var{data:t}=e,a=(arguments.length>1&&void 0!==arguments[1]||new Date,[]),s=t["user-preferences"],r=t.corporate,o=t.inscriptions,i=t["base-assinantes-pd-host-bol-user"],n=t["clusters-conteudo"],c=t.tags,u=t["origem-sessoes"],l=t["tabela-dinamica-clusters-conteudo"];if(i&&(i.description_point_sale&&a.push({group:"tfh-assinante-ponto-venda",item:i.description_point_sale}),i.description_station&&a.push({group:"tfh-assinante-estacao",item:i.description_station}),i.description_product&&a.push({group:"tfh-assinante-produto",item:i.description_product}),i.description_base&&i.description_subscriber_type&&["ASSINANTE","ASSINANTE OUTROS PRODUTOS"].includes(i.description_subscriber_type.toUpperCase())&&("ATIVO"===i.description_base.toUpperCase()?a.push({group:"tfh-assinante-status",item:"assinante"}):"CANCELADO"===i.description_base.toUpperCase()&&a.push({group:"tfh-assinante-status",item:"ex-assinante"})),i.description_base&&a.push({group:"tfh-assinante-base",item:i.description_base}),i.description_subscriber_type&&a.push({group:"tfh-tipo-assinatura",item:i.description_subscriber_type}),i.flg_user_emad_elegivel&&a.push({group:"tfh-flg-user-emad-elegivel",item:i.flg_user_emad_elegivel}),i.description_products_portfolio&&a.push({group:"tfh-desc-products-portfolio",item:i.description_products_portfolio}),!r||i.description_products_portfolio&&i.description_products_portfolio.split("|").map(e=>e.trim().toUpperCase()).includes("CONTEÃšDO")||a.push({group:"tfh-assinante-status",item:"Cadastrado"})),s){if(s.newsletter_assinaturas&&s.newsletter_assinaturas.length)for(var p of s.newsletter_assinaturas)a.push({group:"tfh-newsletter-assinaturas",item:p});if(s.preferencias&&Object.keys(s.preferencias).length&&(s.preferencias["bloco-customizado-esporte"]&&a.push({group:"tfh-preferencias-time",item:s.preferencias["bloco-customizado-esporte"]}),s.preferencias["bloco-customizado-mulher"]&&a.push({group:"tfh-preferencias-signo",item:s.preferencias["bloco-customizado-mulher"]})),s.app_navegacao&&Object.keys(s.app_navegacao).length)for(var[d,f]of Object.entries(s.app_navegacao))a.push({group:"tfh-app-navegacao",item:d});if(s.canais_whatsapp&&Object.keys(s.canais_whatsapp).length)for(var h of Object.keys(s.canais_whatsapp))a.push({group:"tfh-canais-whatsapp",item:h});if(s.webalert_origens&&Object.keys(s.webalert_origens).length)for(var[g,y]of Object.entries(s.webalert_origens))a.push({group:"tfh-webalert-origens",item:g});if(s.webalert_aceite_notificacao&&Object.keys(s.webalert_aceite_notificacao).length)for(var[v,m]of Object.entries(s.webalert_aceite_notificacao))a.push({group:"tfh-webalert-aceite-notific",item:v});if(s.colunas_assinaturas_notificacao&&Object.keys(s.colunas_assinaturas_notificacao).length)for(var[b,_]of Object.entries(s.colunas_assinaturas_notificacao))a.push({group:"tfh-colunas-assinatura-notific",item:b})}if(n&&n.flg_upsell_able_heavy_user&&a.push({group:"tfh-flg-upsell-able-heavy-user",item:n.flg_upsell_able_heavy_user}),o&&o.activeProducts&&o.activeProducts.includes(32)){var D=c&&c.tags;for(var[O,w]of Object.entries({80427:"investimentos",81524:"cardapios",82073:"horoscopo"})){var L=D&&D[O];(!L||L<=5)&&a.push({group:"tfh-consumo-produto-assinatura",item:w})}}if(u&&u.origem_sessoes&&u.origem_sessoes.length)for(var S of u.origem_sessoes)a.push({group:"tfh-origem-sessoes",item:S});if(l)for(var[T,A]of Object.entries(l)){var U=T.split("_").join("-");if("string"==typeof A&&a.push({group:"tfh-".concat(U),item:A}),Array.isArray(A))for(var j of A)a.push({group:"tfh-".concat(U),item:j})}return a},persistForAdvertising(e){this.setTargeting(e),this.persistDataLayer(e)},persist(e){var t=JSON.stringify(e);this.persistForAdvertising({UOLID:e.uolid,ppid:e.ppid}),this.persistLocal(t)},setTargeting(e){var{UOLID:t}=e;try{googletag.pubads().setTargeting("UOLID",t)}catch(e){}},persistLocal(e){localStorage.setItem("UDR.DATA",e)},getLocalData:()=>c((function*(){var e=localStorage.getItem("UDR.DATA");return e?JSON.parse(e):null}))(),getDataLayer:()=>c((function*(){var e=localStorage.getItem("uolDataLayer");return e&&"null"!==e&&"undefined"!==e?JSON.parse(e):{}}))(),getWindowDataLayer:()=>(window.UOLPD=window.UOLPD||{},window.UOLPD.dataLayer=window.UOLPD.dataLayer||{},window.UOLPD.dataLayer),persistDataLayer(e){var t=this;return c((function*(){var a=t.getWindowDataLayer();Object.assign(a,e);var s=yield t.getDataLayer();Object.assign(s,e),localStorage.setItem("uolDataLayer",JSON.stringify(s))}))()},syncTailTarget(){var e=this;return c((function*(){var t=yield e.getDataLayer(),a=t&&t.TailtargetTrack;if(a){var s="";for(var r in a)s+="".concat(r,":").concat(a[r],";");var o="".concat(u,"/store?scope=").concat("tt","&data=").concat(s);(yield e.isNewSync(o,"tt"))&&((new Image).src=o,yield e.saveSyncHash(o,"tt"))}}))()},getXandrUid:()=>c((function*(){try{var e=yield fetch("https://ib.adnxs.com/getuidj",{credentials:"include"});return(yield e.json()).uid}catch(e){return console.log("Ops! ocorreu um erro ao obter o XandrUID"),"0"}}))(),syncXandrDMP(){var e=this;return c((function*(){var t=yield e.getXandrUid();"0"!=t&&/^(0x)?[0-9A-Fa-f]+$/.test(t)&&((new Image).src="".concat(u,"/store?scope=xandr&sid=").concat(t))}))()},saveSyncHash(e,t){var a=this;return c((function*(){var s=yield a.getLocalData(),{syncHashMap:r={}}=s,i=yield o(e);r[t]=i,s.syncHashMap=r,a.persistLocal(JSON.stringify(s))}))()},isNewSync(e,t){var a=this;return c((function*(){var s=yield a.getLocalData(),{syncHashMap:r={}}=s,i=yield o(e);return r[t]!=i}))()},sendUOLIDToTailTarget(){var e=this;return c((function*(){var t=yield e.getLocalData(),a="https://m.t.tailtarget.com/sync/TT-10162-1/"+(yield o(t.uolid));document.createElement("img").setAttribute("src",a)}))()},syncWeather(){var e=this;return c((function*(){try{var t=yield e.getLocalData(),a=yield fetch("https://dynad-list.dynad.net/v3/weather?uolid=".concat(t.uolid)),s=yield a.json();e.persistDataLayer({weather:s.main});var r=JSON.parse(localStorage.getItem("UDR.DATA"));Object.assign(r,{weather:s.main}),e.persistLocal(JSON.stringify(r))}catch(e){console.log("Falha ao obter os dados de clima")}}))()},setCustomAudiencesInWindowsDataLayer(){var e=this;return c((function*(){var t=e.getUDRData().data;yield e.evinoLoad(t),yield e.caApostasLoad(t),yield e.caApostasV2Load(t),yield e.caTimUsuariosSeteAcessos(t),yield e.caLookAlikeV1(t),yield e.setBTAssinantes(t)}))()},persistInBtDatalayer(e){var t=this.getWindowDataLayer();t.bt=t.bt+","+e},evinoLoad(e){var t=this;return c((function*(){try{e["teste-evino"]&&t.persistInBtDatalayer("evino_2023")}catch(e){console.log("Falha ao obter os dados de evino")}}))()},caApostasLoad(e){var t=this;return c((function*(){try{e["ca-apostas-2024"]&&t.persistInBtDatalayer("ca_apostas_2024")}catch(e){console.log("Falha ao obter os dados da custom_audience_apostas")}}))()},caApostasV2Load(e){var t=this;return c((function*(){try{e["ca-apostas-v2-2024"]&&t.persistInBtDatalayer("ca-apostas-v2-2024")}catch(e){console.log("Falha ao obter os dados da custom_audience_apostas-V2")}}))()},caTimUsuariosSeteAcessos(e){var t=this;return c((function*(){try{e["ca-tim-usuarios-sete-acessos"]&&t.persistInBtDatalayer("ca-tim-usuarios-sete-acessos")}catch(e){console.log("Falha ao obter os dados do scopo ca-tim-usuarios-sete-acessos")}}))()},caLookAlikeV1(e){var t=this;return c((function*(){try{e["ca-look-alike-v1"]&&t.persistInBtDatalayer("ca-look-alike-v1")}catch(e){console.log("Falha ao obter os dados do scopo ca-look-alike-v1")}}))()},setBTAssinantes(e){var t=this;return c((function*(){try{var a=e.inscriptions;a&&(a.activeProducts&&a.activeProducts.length>0||a.activeServices&&a.activeServices.length>0)&&t.persistInBtDatalayer("assinante")}catch(e){console.log("Falha ao obter os dados de assinatura")}}))()}};p.sync()}]);
